<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Visualisation of biomolecular data</title>
  <meta name="description" content="Visualisation of biomolecular data">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Visualisation of biomolecular data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Visualisation of biomolecular data" />
  <meta name="github-repo" content="lgatto/VisualisingBiomolecularData" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Visualisation of biomolecular data" />
  
  <meta name="twitter:description" content="Visualisation of biomolecular data" />
  

<meta name="author" content="Laurent Gatto">


<meta name="date" content="2018-04-30">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="index.html">
<link rel="next" href="exploring-and-visualising-biomolecular-data.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#questions"><i class="fa fa-check"></i><b>1.2</b> Questions</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.3</b> License</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#useful-references"><i class="fa fa-check"></i><b>1.4</b> Useful references</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html"><i class="fa fa-check"></i><b>2</b> Example datasets and data manipulation</a><ul>
<li class="chapter" data-level="2.1" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#raw-ms-data"><i class="fa fa-check"></i><b>2.1</b> Raw MS data</a></li>
<li class="chapter" data-level="2.2" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#the-iprg-data"><i class="fa fa-check"></i><b>2.2</b> The iPRG data</a></li>
<li class="chapter" data-level="2.3" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#crc-training-data"><i class="fa fa-check"></i><b>2.3</b> CRC training data</a></li>
<li class="chapter" data-level="2.4" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#all-data"><i class="fa fa-check"></i><b>2.4</b> ALL data</a></li>
<li class="chapter" data-level="2.5" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#using-dplyr-for-data-manipulation"><i class="fa fa-check"></i><b>2.5</b> Using <code>dplyr</code> for data manipulation</a><ul>
<li class="chapter" data-level="2.5.1" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>2.5.1</b> Selecting columns and filtering rows</a></li>
<li class="chapter" data-level="2.5.2" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#pipes"><i class="fa fa-check"></i><b>2.5.2</b> Pipes</a></li>
<li class="chapter" data-level="2.5.3" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#mutate"><i class="fa fa-check"></i><b>2.5.3</b> Mutate</a></li>
<li class="chapter" data-level="2.5.4" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#split-apply-combine-data-analysis-and-the-summarize-function"><i class="fa fa-check"></i><b>2.5.4</b> Split-apply-combine data analysis and the summarize() function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exploring-and-visualising-biomolecular-data.html"><a href="exploring-and-visualising-biomolecular-data.html"><i class="fa fa-check"></i><b>3</b> Exploring and visualising biomolecular data</a></li>
<li class="chapter" data-level="4" data-path="plotting-in-r.html"><a href="plotting-in-r.html"><i class="fa fa-check"></i><b>4</b> Plotting in R</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-in-r.html"><a href="plotting-in-r.html#base-graphics"><i class="fa fa-check"></i><b>4.1</b> Base graphics</a></li>
<li class="chapter" data-level="4.2" data-path="plotting-in-r.html"><a href="plotting-in-r.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>4.2</b> Plotting with <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.3" data-path="plotting-in-r.html"><a href="plotting-in-r.html#customising-plots"><i class="fa fa-check"></i><b>4.3</b> Customising plots</a></li>
<li class="chapter" data-level="4.4" data-path="plotting-in-r.html"><a href="plotting-in-r.html#saving-your-figures"><i class="fa fa-check"></i><b>4.4</b> Saving your figures</a></li>
<li class="chapter" data-level="4.5" data-path="plotting-in-r.html"><a href="plotting-in-r.html#references"><i class="fa fa-check"></i><b>4.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="using-r-and-bioconductor-for-ms-based-proteomics.html"><a href="using-r-and-bioconductor-for-ms-based-proteomics.html"><i class="fa fa-check"></i><b>5</b> Using R and Bioconductor for MS-based proteomics</a></li>
<li class="chapter" data-level="6" data-path="tools-and-plots.html"><a href="tools-and-plots.html"><i class="fa fa-check"></i><b>6</b> Tools and plots</a><ul>
<li class="chapter" data-level="6.1" data-path="tools-and-plots.html"><a href="tools-and-plots.html#transformations"><i class="fa fa-check"></i><b>6.1</b> Transformations</a><ul>
<li class="chapter" data-level="6.1.1" data-path="tools-and-plots.html"><a href="tools-and-plots.html#expression-data"><i class="fa fa-check"></i><b>6.1.1</b> Expression data</a></li>
<li class="chapter" data-level="6.1.2" data-path="tools-and-plots.html"><a href="tools-and-plots.html#fold-changes"><i class="fa fa-check"></i><b>6.1.2</b> Fold changes</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="tools-and-plots.html"><a href="tools-and-plots.html#comparing-samples-and-linear-models"><i class="fa fa-check"></i><b>6.2</b> Comparing samples and linear models</a></li>
<li class="chapter" data-level="6.3" data-path="tools-and-plots.html"><a href="tools-and-plots.html#plots-for-statistical-analyses"><i class="fa fa-check"></i><b>6.3</b> Plots for statistical analyses</a></li>
<li class="chapter" data-level="6.4" data-path="tools-and-plots.html"><a href="tools-and-plots.html#visualising-intersections"><i class="fa fa-check"></i><b>6.4</b> Visualising intersections</a></li>
<li class="chapter" data-level="6.5" data-path="tools-and-plots.html"><a href="tools-and-plots.html#unsupervised-learning"><i class="fa fa-check"></i><b>6.5</b> Unsupervised learning</a><ul>
<li class="chapter" data-level="6.5.1" data-path="tools-and-plots.html"><a href="tools-and-plots.html#k-means-clustering"><i class="fa fa-check"></i><b>6.5.1</b> k-means clustering</a></li>
<li class="chapter" data-level="6.5.2" data-path="tools-and-plots.html"><a href="tools-and-plots.html#hierarchical-clustering"><i class="fa fa-check"></i><b>6.5.2</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="6.5.3" data-path="tools-and-plots.html"><a href="tools-and-plots.html#pre-processing"><i class="fa fa-check"></i><b>6.5.3</b> Pre-processing</a></li>
<li class="chapter" data-level="6.5.4" data-path="tools-and-plots.html"><a href="tools-and-plots.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>6.5.4</b> Principal component analysis (PCA)</a></li>
<li class="chapter" data-level="6.5.5" data-path="tools-and-plots.html"><a href="tools-and-plots.html#t-distributed-stochastic-neighbour-embedding"><i class="fa fa-check"></i><b>6.5.5</b> t-Distributed Stochastic Neighbour Embedding</a></li>
<li class="chapter" data-level="6.5.6" data-path="tools-and-plots.html"><a href="tools-and-plots.html#pca-loadins-vs-differential-expression"><i class="fa fa-check"></i><b>6.5.6</b> PCA loadins vs differential expression</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="tools-and-plots.html"><a href="tools-and-plots.html#heatmaps"><i class="fa fa-check"></i><b>6.6</b> Heatmaps</a><ul>
<li class="chapter" data-level="6.6.1" data-path="tools-and-plots.html"><a href="tools-and-plots.html#heatmap-components"><i class="fa fa-check"></i><b>6.6.1</b> Heatmap components</a></li>
<li class="chapter" data-level="6.6.2" data-path="tools-and-plots.html"><a href="tools-and-plots.html#data-reordering"><i class="fa fa-check"></i><b>6.6.2</b> Data reordering</a></li>
<li class="chapter" data-level="6.6.3" data-path="tools-and-plots.html"><a href="tools-and-plots.html#distance"><i class="fa fa-check"></i><b>6.6.3</b> Distance</a></li>
<li class="chapter" data-level="6.6.4" data-path="tools-and-plots.html"><a href="tools-and-plots.html#clustering-agglomeration"><i class="fa fa-check"></i><b>6.6.4</b> Clustering (agglomeration)</a></li>
<li class="chapter" data-level="6.6.5" data-path="tools-and-plots.html"><a href="tools-and-plots.html#image-representation"><i class="fa fa-check"></i><b>6.6.5</b> Image representation</a></li>
<li class="chapter" data-level="6.6.6" data-path="tools-and-plots.html"><a href="tools-and-plots.html#colour-mapping"><i class="fa fa-check"></i><b>6.6.6</b> Colour mapping</a></li>
<li class="chapter" data-level="6.6.7" data-path="tools-and-plots.html"><a href="tools-and-plots.html#colour-palette"><i class="fa fa-check"></i><b>6.6.7</b> Colour palette</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html"><i class="fa fa-check"></i><b>7</b> Interactive visualisation</a></li>
<li class="chapter" data-level="8" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i><b>8</b> Session information</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visualisation of biomolecular data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="example-datasets-and-data-manipulation" class="section level1">
<h1><span class="header-section-number">Chapter 2</span> Example datasets and data manipulation</h1>
<p>We will used various datasets throughout the course. These data are briefly described below, and we will explore them through various visualisations later. This section also introduces some techniques to manipulate data and transorm them into different formats.</p>
<div id="raw-ms-data" class="section level2">
<h2><span class="header-section-number">2.1</span> Raw MS data</h2>
<p>Section <em>Using R and Bioconductor for MS-based proteomics</em> shows how to visualise raw mass spectrometry data. The raw data that will be using come from the <em><a href="http://bioconductor.org/packages/msdata">msdata</a></em> <em><a href="http://bioconductor.org/packages/MSnbase">MSnbase</a></em> packages. These data will be introduced later.</p>
</div>
<div id="the-iprg-data" class="section level2">
<h2><span class="header-section-number">2.2</span> The iPRG data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprg &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://bit.ly/VisBiomedDataIprgCsv&quot;</span>)
<span class="kw">head</span>(iprg)</code></pre></div>
<pre><code>##                Protein Log2Intensity                       Run  Condition
## 1 sp|D6VTK4|STE2_YEAST      26.81232 JD_06232014_sample1_B.raw Condition1
## 2 sp|D6VTK4|STE2_YEAST      26.60786 JD_06232014_sample1_C.raw Condition1
## 3 sp|D6VTK4|STE2_YEAST      26.58301 JD_06232014_sample1-A.raw Condition1
## 4 sp|D6VTK4|STE2_YEAST      26.83563 JD_06232014_sample2_A.raw Condition2
## 5 sp|D6VTK4|STE2_YEAST      26.79430 JD_06232014_sample2_B.raw Condition2
## 6 sp|D6VTK4|STE2_YEAST      26.60863 JD_06232014_sample2_C.raw Condition2
##   BioReplicate Intensity TechReplicate
## 1            1 117845016             B
## 2            1 102273602             C
## 3            1 100526837             A
## 4            2 119765106             A
## 5            2 116382798             B
## 6            2 102328260             C</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(iprg)</code></pre></div>
<pre><code>## [1] 36321     7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(iprg<span class="op">$</span>Condition, iprg<span class="op">$</span>TechReplicate)</code></pre></div>
<pre><code>##             
##                 A    B    C
##   Condition1 3026 3026 3027
##   Condition2 3027 3027 3027
##   Condition3 3027 3027 3027
##   Condition4 3027 3026 3027</code></pre>
<p>Reference:</p>
<blockquote>
<p>Choi M, Eren-Dogu ZF, Colangelo C, Cottrell J, Hoopmann MR, Kapp EA, Kim S, Lam H, Neubert TA, Palmblad M, Phinney BS, Weintraub ST, MacLean B, Vitek O. <em>ABRF Proteome Informatics Research Group (iPRG) 2015 Study: Detection of Differentially Abundant Proteins in Label-Free Quantitative LC-MS/MS Experiments</em>. J Proteome Res. 2017 Feb 3;16(2):945-957. doi: <a href="https://doi.org/10.1021/acs.jproteome.6b00881">10.1021/acs.jproteome.6b00881</a> Epub 2017 Jan 3. PMID: 27990823.</p>
</blockquote>
<p>This data is in the so-called long format. In some applications, it is more convenient to have the data in wide format, where rows contain the protein expression data for all samples.</p>
<p>Let’s start by simplifying the data to keep only the relevant columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(iprg2 &lt;-<span class="st"> </span>iprg[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">6</span>)])</code></pre></div>
<pre><code>##                Protein                       Run Intensity
## 1 sp|D6VTK4|STE2_YEAST JD_06232014_sample1_B.raw 117845016
## 2 sp|D6VTK4|STE2_YEAST JD_06232014_sample1_C.raw 102273602
## 3 sp|D6VTK4|STE2_YEAST JD_06232014_sample1-A.raw 100526837
## 4 sp|D6VTK4|STE2_YEAST JD_06232014_sample2_A.raw 119765106
## 5 sp|D6VTK4|STE2_YEAST JD_06232014_sample2_B.raw 116382798
## 6 sp|D6VTK4|STE2_YEAST JD_06232014_sample2_C.raw 102328260</code></pre>
<p>We can convert the <code>iPRG</code> into a wide format with <code>tidyr::spread</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;tidyr&quot;</span>)
iprg3 &lt;-<span class="st"> </span><span class="kw">spread</span>(iprg2, <span class="dt">key =</span> Run, <span class="dt">value =</span> Intensity)
<span class="kw">head</span>(iprg3)</code></pre></div>
<pre><code>##                 Protein JD_06232014_sample1-A.raw
## 1  sp|D6VTK4|STE2_YEAST                 100526837
## 2  sp|O13297|CET1_YEAST                  27598550
## 3  sp|O13329|FOB1_YEAST                  11625198
## 4  sp|O13539|THP2_YEAST                  20606703
## 5 sp|O13547|CCW14_YEAST                 145493943
## 6 sp|O13563|RPN13_YEAST                  75530595
##   JD_06232014_sample1_B.raw JD_06232014_sample1_C.raw
## 1                 117845016                 102273602
## 2                  27618234                  26774670
## 3                  10892143                  16948335
## 4                 192490784                 175282010
## 5                 156581624                 117211277
## 6                  71664672                  82193735
##   JD_06232014_sample2_A.raw JD_06232014_sample2_B.raw
## 1                 119765106                 116382798
## 2                  24114625                  26803677
## 3                   9448487                  11334921
## 4                  61781078                  72052121
## 5                 151407246                 126364703
## 6                  62998676                  73431260
##   JD_06232014_sample2_C.raw JD_06232014_sample3_A.raw
## 1                 102328260                 103830944
## 2                  25055912                  21977898
## 3                  14304554                  19285356
## 4                  62895992                  52653164
## 5                 123774524                  99222081
## 6                  67612042                  75916420
##   JD_06232014_sample3_B.raw JD_06232014_sample3_C.raw
## 1                  94660680                  96919972
## 2                  25901361                  26545544
## 3                  10230925                  13985282
## 4                  84856844                  63400641
## 5                 113287367                 129669642
## 6                  68877388                  72632994
##   JD_06232014_sample4-A.raw JD_06232014_sample4_B.raw
## 1                 105724288                 102150172
## 2                  23860882                  26305424
## 3                   8592981                   9414560
## 4                  35363603                 109094905
## 5                 141404829                 132444723
## 6                  57600421                  70708409
##   JD_06232014_sample4_C.raw
## 1                  87702341
## 2                  26612349
## 3                  12783705
## 4                  63392610
## 5                 117065261
## 6                  69675572</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(iprg3)</code></pre></div>
<pre><code>## [1] 3027</code></pre>
<p>Indeed, we started with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">length</span>(<span class="kw">unique</span>(iprg<span class="op">$</span>Protein))</code></pre></div>
<pre><code>## [1] 3027</code></pre>
<p>unique proteins, which corresponds to the number of rows in the new wide dataset.</p>
<p>The long format is ideal when using <code>ggplot2</code>, as we will see in a later chapter. The wide format has also advantages. For example, it becomes straighforward to verify if there are proteins that haven’t been quantified in some samples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">(k &lt;-<span class="st"> </span><span class="kw">which</span>(<span class="kw">is.na</span>(iprg3), <span class="dt">arr.ind =</span> <span class="kw">dim</span>(iprg3)))</code></pre></div>
<pre><code>##       row col
## [1,] 2721   2
## [2,] 2721   3
## [3,]  652  12</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprg3[<span class="kw">unique</span>(k[, <span class="st">&quot;row&quot;</span>]), ]</code></pre></div>
<pre><code>##                    Protein JD_06232014_sample1-A.raw
## 2721  sp|Q08236|AVO1_YEAST                        NA
## 652  sp|P28320|CWC16_YEAST                   1108670
##      JD_06232014_sample1_B.raw JD_06232014_sample1_C.raw
## 2721                        NA                  10989286
## 652                   961273.8                   1229085
##      JD_06232014_sample2_A.raw JD_06232014_sample2_B.raw
## 2721                 5407419.7                   2041424
## 652                   449839.1                   1334009
##      JD_06232014_sample2_C.raw JD_06232014_sample3_A.raw
## 2721                  13108081                   4677052
## 652                    1633894                   1493440
##      JD_06232014_sample3_B.raw JD_06232014_sample3_C.raw
## 2721                  10308957                  13639794
## 652                    2205688                   2120321
##      JD_06232014_sample4-A.raw JD_06232014_sample4_B.raw
## 2721                10377088.4                   2592511
## 652                   757082.7                        NA
##      JD_06232014_sample4_C.raw
## 2721                  10420338
## 652                    1264712</code></pre>
<p>The opposite operation to <code>spread</code> is <code>gather</code>, also from the <code>tidyr</code> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(iprg4 &lt;-<span class="st"> </span><span class="kw">gather</span>(iprg3, <span class="dt">key =</span> Run, <span class="dt">value =</span> Intensity, <span class="op">-</span>Protein))</code></pre></div>
<pre><code>##                 Protein                       Run Intensity
## 1  sp|D6VTK4|STE2_YEAST JD_06232014_sample1-A.raw 100526837
## 2  sp|O13297|CET1_YEAST JD_06232014_sample1-A.raw  27598550
## 3  sp|O13329|FOB1_YEAST JD_06232014_sample1-A.raw  11625198
## 4  sp|O13539|THP2_YEAST JD_06232014_sample1-A.raw  20606703
## 5 sp|O13547|CCW14_YEAST JD_06232014_sample1-A.raw 145493943
## 6 sp|O13563|RPN13_YEAST JD_06232014_sample1-A.raw  75530595</code></pre>
<p>The two lond datasets, <code>iprg2</code> and <code>iprg4</code> are different due to the missing values shown above.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(iprg2)</code></pre></div>
<pre><code>## [1] 36321</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(iprg4)</code></pre></div>
<pre><code>## [1] 36324</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(<span class="kw">na.omit</span>(iprg4))</code></pre></div>
<pre><code>## [1] 36321</code></pre>
<p>which can be accounted for by removing rows with missing values by setting <code>na.rm = TRUE</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(iprg5 &lt;-<span class="st"> </span><span class="kw">gather</span>(iprg3, <span class="dt">key =</span> Run, <span class="dt">value =</span> Intensity, <span class="op">-</span>Protein, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>##                 Protein                       Run Intensity
## 1  sp|D6VTK4|STE2_YEAST JD_06232014_sample1-A.raw 100526837
## 2  sp|O13297|CET1_YEAST JD_06232014_sample1-A.raw  27598550
## 3  sp|O13329|FOB1_YEAST JD_06232014_sample1-A.raw  11625198
## 4  sp|O13539|THP2_YEAST JD_06232014_sample1-A.raw  20606703
## 5 sp|O13547|CCW14_YEAST JD_06232014_sample1-A.raw 145493943
## 6 sp|O13563|RPN13_YEAST JD_06232014_sample1-A.raw  75530595</code></pre>
</div>
<div id="crc-training-data" class="section level2">
<h2><span class="header-section-number">2.3</span> CRC training data</h2>
<p>This dataset comes from the <em><a href="http://bioconductor.org/packages/MSstatsBioData">MSstatsBioData</a></em> package and was generated as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;MSstats&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;MSstatsBioData&quot;</span>)
<span class="kw">data</span>(SRM_crc_training)
Quant &lt;-<span class="st"> </span><span class="kw">dataProcess</span>(SRM_crc_training)
subjectQuant &lt;-<span class="st"> </span><span class="kw">quantification</span>(Quant)</code></pre></div>
<p>It provides quantitative information for 72 proteins, including two standard proteins, <em>AIAG-Bovine</em> and <em>FETUA-Bovine</em>. These proteins were targeted for plasma samples with SRM with isotope labeled reference peptides in order to identify candidate protein biomarker for non-invasive detection of CRC. The training cohort included 100 subjects in control group and 100 subjects with CRC. Each sample for subject was measured in a single injection without technical replicate. The training cohort was analyzed with Skyline. The dataset was already normalized as described in manuscript. User do not need extra normalization. NAs should be considered as censored missing. Two standard proteins can be removed for statistical analysis.</p>
<p>Clinical information where added manually thereafter.</p>
<p>To load this dataset:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crcdf &lt;-<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;http://bit.ly/VisBiomedDataCrcCsv&quot;</span>)
crcdf[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]</code></pre></div>
<pre><code>##       A1AG2      AFM     AHSG
## 1  14.23816 16.10302 19.95179
## 2  15.02411 16.02071 19.71592
## 3  15.63136 16.14380 19.71085
## 4  15.40137 16.27642 19.70438
## 5  16.00316 16.95821 20.42033
## 6  13.93242 16.52772 19.88985
## 7  14.34155 16.43029 20.10060
## 8  13.57086 17.11052 19.93833
## 9  15.83348 15.88189 18.64270
## 10 15.37996 16.22621 20.09992</code></pre>
<p>This dataset is in the wide format. It contains the intensity of the proteins in columns 1 to 72 for each of the 200 samples along the rows. Generally, omics datasets contain the features (proteins, transcripts, …) along the rows and the samples along the columns.</p>
<p>In columns 73 to 79, we sample metadata.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">crcdf[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dv">73</span><span class="op">:</span><span class="dv">79</span>]</code></pre></div>
<pre><code>##    Sample Group Age Gender Cancer_stage Tumour_location Sub_group
## 1   P1A10   CRC  60 female            1           colon       CRC
## 2    P1A2   CRC  70   male            1          rectum       CRC
## 3    P1A4   CRC  65   male            1          rectum       CRC
## 4    P1A6   CRC  65 female            4           colon       CRC
## 5   P1B12   CRC  62 female            3           colon       CRC
## 6    P1B2   CRC  55   male            2           colon       CRC
## 7    P1B3   CRC  61   male            2          rectum       CRC
## 8    P1B6   CRC  52   male            4          rectum       CRC
## 9    P1B9   CRC  89 female            4           colon       CRC
## 10  P1C11   CRC  81   male            1          rectum       CRC</code></pre>
<p>A widely used data structure for omics data follows the convention described in the figure below:</p>
<div class="figure">
<img src="img/msnset.png" alt="An eSet-type of expression data container" />
<p class="caption">An eSet-type of expression data container</p>
</div>
<p>This typical omics data structure, as defined by the <code>eSet</code> class in the Bioconductor <code>Biobase</code> package, is represented below. It’s main features are</p>
<ul>
<li><p>An assay data slot containing the quantitative omics data (expression data), stored as a <code>matrix</code> and accessible with <code>exprs</code>. Features defined along the rows and samples along the columns.</p></li>
<li><p>A sample metadata slot containing sample co-variates, stored as an annotated <code>data.frame</code> and accessible with <code>pData</code>. This data frame is stored with rows representing samples and sample covariate along the columns, and its rows match the expression data columns exactly.</p></li>
<li><p>A feature metadata slot containing feature co-variates, stored as an annotated <code>data.frame</code> and accessible with <code>fData</code>. This dataframe’s rows match the expression data rows exactly.</p></li>
</ul>
<p>The coordinated nature of the high throughput data guarantees that the dimensions of the different slots will always match (i.e the columns in the expression data and then rows in the sample metadata, as well as the rows in the expression data and feature metadata) during data manipulation. The metadata slots can grow additional co-variates (columns) without affecting the other structures.</p>
<p>Below, we show how to transform the <code>crc</code> dataset into an <code>MSnSet</code> (implementing the data structure above for quantitative proteomics data) using the <code>readMSnSet2</code> function.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;MSnbase&quot;</span>)
i &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">72</span> ## expression columns
e &lt;-<span class="st"> </span><span class="kw">t</span>(crcdf[, i]) ## expression data
<span class="kw">colnames</span>(e) &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">200</span>
crc &lt;-<span class="st"> </span><span class="kw">readMSnSet2</span>(<span class="kw">data.frame</span>(e), <span class="dt">e =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">200</span>)

pd &lt;-<span class="st"> </span>crcdf[, <span class="op">-</span>i]
<span class="kw">rownames</span>(pd) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;X&quot;</span>, <span class="kw">rownames</span>(pd))
<span class="kw">pData</span>(crc) &lt;-<span class="st"> </span>pd
crc</code></pre></div>
<pre><code>## MSnSet (storageMode: lockedEnvironment)
## assayData: 72 features, 200 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: X1 X2 ... X200 (200 total)
##   varLabels: Sample Group ... Sub_group (7 total)
##   varMetadata: labelDescription
## featureData: none
## experimentData: use &#39;experimentData(object)&#39;
## Annotation:  
## - - - Processing information - - -
##  MSnbase version: 2.5.14</code></pre>
<p>Or load it direcly:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">download.file</span>(<span class="st">&quot;http://bit.ly/VisBiomedDataCrcMSnSet&quot;</span>, <span class="st">&quot;./data/crc.rda&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;./data/crc.rda&quot;</span>)
crc</code></pre></div>
<pre><code>## MSnSet (storageMode: lockedEnvironment)
## assayData: 72 features, 200 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: X1 X2 ... X200 (200 total)
##   varLabels: Sample Group ... Sub_group (7 total)
##   varMetadata: labelDescription
## featureData: none
## experimentData: use &#39;experimentData(object)&#39;
## Annotation:  
## - - - Processing information - - -
##  MSnbase version: 2.5.14</code></pre>
<p>Reference:</p>
<blockquote>
<p>See Surinova, S. et al. (2015) <em>Prediction of colorectal cancer diagnosis based on circulating plasma proteins</em>. EMBO Mol. Med., 7, 1166–1178 for details.</p>
</blockquote>
</div>
<div id="all-data" class="section level2">
<h2><span class="header-section-number">2.4</span> ALL data</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ALL&quot;</span>)
<span class="kw">data</span>(ALL)
ALL</code></pre></div>
<pre><code>## ExpressionSet (storageMode: lockedEnvironment)
## assayData: 12625 features, 128 samples 
##   element names: exprs 
## protocolData: none
## phenoData
##   sampleNames: 01005 01010 ... LAL4 (128 total)
##   varLabels: cod diagnosis ... date last seen (21 total)
##   varMetadata: labelDescription
## featureData: none
## experimentData: use &#39;experimentData(object)&#39;
##   pubMedIds: 14684422 16243790 
## Annotation: hgu95av2</code></pre>
<p>From the documentation page:</p>
<blockquote>
<p>The <em>Acute Lymphoblastic Leukemia Data from the Ritz Laboratory</em> consist of microarrays from 128 different individuals with acute lymphoblastic leukemia (ALL). A number of additional covariates are available. The data have been normalized (using rma) and it is the jointly normalized data that are available here.</p>
</blockquote>
<p>The <code>ALL</code> data is of class <code>ExpressionSet</code>, which implements the data structure above for microarray expression data, and contains normalised and summarised transcript intensities.</p>
<p>Below, we select will patients with B-cell lymphomas and BCR/ABL abnormality and negative controls.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(ALL<span class="op">$</span>BT)</code></pre></div>
<pre><code>## 
##  B B1 B2 B3 B4  T T1 T2 T3 T4 
##  5 19 36 23 12  5  1 15 10  2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">table</span>(ALL<span class="op">$</span>mol.biol)</code></pre></div>
<pre><code>## 
## ALL1/AF4  BCR/ABL E2A/PBX1      NEG   NUP-98  p15/p16 
##       10       37        5       74        1        1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ALL_bcrneg &lt;-<span class="st"> </span>ALL[, ALL<span class="op">$</span>mol.biol <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;NEG&quot;</span>, <span class="st">&quot;BCR/ABL&quot;</span>) <span class="op">&amp;</span><span class="st"> </span><span class="kw">grepl</span>(<span class="st">&quot;B&quot;</span>, ALL<span class="op">$</span>BT)]
ALL_bcrneg<span class="op">$</span>mol.biol &lt;-<span class="st"> </span><span class="kw">factor</span>(ALL_bcrneg<span class="op">$</span>mol.biol)</code></pre></div>
<p>We then use the <em><a href="http://bioconductor.org/packages/limma">limma</a></em> package to</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;limma&quot;</span>)
design &lt;-<span class="st"> </span><span class="kw">model.matrix</span>(<span class="op">~</span><span class="dv">0</span><span class="op">+</span>ALL_bcrneg<span class="op">$</span>mol.biol)
<span class="kw">colnames</span>(design) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;BCR.ABL&quot;</span>, <span class="st">&quot;NEG&quot;</span>)

## Step1: linear model. lmFit is a wrapper around lm in R
fit1 &lt;-<span class="st"> </span><span class="kw">lmFit</span>(ALL_bcrneg, design)

## Step 2: fit contrasts: find genes that respond to estrogen
contrast.matrix &lt;-<span class="st"> </span><span class="kw">makeContrasts</span>(BCR.ABL<span class="op">-</span>NEG, <span class="dt">levels =</span> design)
fit2 &lt;-<span class="st"> </span><span class="kw">contrasts.fit</span>(fit1, contrast.matrix)

## Step3: add empirical Bayes moderation
fit3 &lt;-<span class="st"> </span><span class="kw">eBayes</span>(fit2)

## Extract results and set them to the feature data
res &lt;-<span class="st"> </span><span class="kw">topTable</span>(fit3, <span class="dt">n =</span> <span class="ot">Inf</span>)
<span class="kw">fData</span>(ALL_bcrneg) &lt;-<span class="st"> </span>res[<span class="kw">featureNames</span>(ALL_bcrneg), ]</code></pre></div>
<p>This annotated <code>ExpressionSet</code> can be reproduced as shown above or downloaded and loaded using</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">download.file</span>(<span class="st">&quot;http://bit.ly/VisBiomedDataALL_bcrneg&quot;</span>,  <span class="st">&quot;./data/ALL_bcrneg.rda&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;./data/ALL_bcrneg.rda&quot;</span>)</code></pre></div>
<p>Reference:</p>
<blockquote>
<p>Sabina Chiaretti, Xiaochun Li, Robert Gentleman, Antonella Vitale, Marco Vignetti, Franco Mandelli, Jerome Ritz, and Robin Foa <em>Gene expression profile of adult T-cell acute lymphocytic leukemia identifies distinct subsets of patients with different response to therapy and survival</em>. Blood, 1 April 2004, Vol. 103, No. 7.</p>
</blockquote>
</div>
<div id="using-dplyr-for-data-manipulation" class="section level2">
<h2><span class="header-section-number">2.5</span> Using <code>dplyr</code> for data manipulation</h2>
<blockquote>
<p>The following material is based on Data Carpentry’s the <a href="http://www.datacarpentry.org/R-ecology-lesson/">Data analisis and visualisation</a> lessons.</p>
</blockquote>
<p>Bracket subsetting is handy, but it can be cumbersome and difficult to read, especially for complicated operations. Enter <strong><code>dplyr</code></strong>. <strong><code>dplyr</code></strong> is a package for making tabular data manipulation easier. It pairs nicely with <strong><code>tidyr</code></strong> which enables you to swiftly convert between different data formats for plotting and analysis.</p>
<p>We will need the <a href="https://www.tidyverse.org/"><code>tidyverse</code></a> package. This is an “umbrella-package” that installs several packages useful for data analysis which work together well such as <code>dplyr</code>, <code>ggplot2</code> (for visualisation), <code>tibble</code>, etc.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;tidyverse&quot;</span>)</code></pre></div>
<pre><code>## ── Attaching packages ────────────────────────────────── tidyverse 1.2.1 ──</code></pre>
<pre><code>## ✔ tibble  1.4.2          ✔ dplyr   0.7.4.9003
## ✔ purrr   0.2.4          ✔ stringr 1.3.0     
## ✔ tibble  1.4.2          ✔ forcats 0.3.0</code></pre>
<pre><code>## ── Conflicts ───────────────────────────────────── tidyverse_conflicts() ──
## ✖ dplyr::collapse()        masks IRanges::collapse()
## ✖ dplyr::combine()         masks MSnbase::combine(), Biobase::combine(), BiocGenerics::combine()
## ✖ dplyr::desc()            masks IRanges::desc()
## ✖ tidyr::expand()          masks S4Vectors::expand()
## ✖ dplyr::exprs()           masks affy::exprs(), MSnbase::exprs(), Biobase::exprs()
## ✖ magrittr::extract()      masks tidyr::extract()
## ✖ dplyr::filter()          masks stats::filter()
## ✖ dplyr::first()           masks S4Vectors::first()
## ✖ dplyr::lag()             masks stats::lag()
## ✖ BiocGenerics::Position() masks ggplot2::Position(), base::Position()
## ✖ purrr::reduce()          masks IRanges::reduce(), MSnbase::reduce()
## ✖ dplyr::rename()          masks S4Vectors::rename()
## ✖ dplyr::select()          masks AnnotationDbi::select()
## ✖ purrr::set_names()       masks magrittr::set_names()
## ✖ dplyr::slice()           masks IRanges::slice()</code></pre>
<p>The <code>tidyverse</code> package tries to address 3 major problems with some of base R functions:</p>
<ol style="list-style-type: decimal">
<li>The results from a base R function sometimes depends on the type of data.</li>
<li>Using R expressions in a non standard way, which can be confusing for new learners.</li>
<li>Hidden arguments, having default operations that new learners are not aware of.</li>
</ol>
<p>To learn more about <strong><code>dplyr</code></strong> and <strong><code>tidyr</code></strong>, you may want to check out this <a href="https://github.com/rstudio/cheatsheets/raw/master/data-transformation.pdf">handy data transformation with <strong><code>dplyr</code></strong> cheatsheet</a> and this <a href="https://github.com/rstudio/cheatsheets/raw/master/data-import.pdf">one about <strong><code>tidyr</code></strong></a>.</p>
<p>Let’s start by reading the data using <code>readr::read_csv</code> that will produce a <code>tibble</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;readr&quot;</span>)
iprg &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&quot;http://bit.ly/VisBiomedDataIprgCsv&quot;</span>)</code></pre></div>
<pre><code>## Parsed with column specification:
## cols(
##   Protein = col_character(),
##   Log2Intensity = col_double(),
##   Run = col_character(),
##   Condition = col_character(),
##   BioReplicate = col_integer(),
##   Intensity = col_double(),
##   TechReplicate = col_character()
## )</code></pre>
<p>Tibbles are data frames, but they tweak some of the old behaviors of data frames. The data structure is very similar to a data frame. For our purposes the only differences are that:</p>
<ol style="list-style-type: decimal">
<li>In addition to displaying the data type of each column under its name, it only prints the first few rows of data and only as many columns as fit on one screen.</li>
<li>Columns of class <code>character</code> are never converted into factors.</li>
</ol>
<div id="selecting-columns-and-filtering-rows" class="section level3">
<h3><span class="header-section-number">2.5.1</span> Selecting columns and filtering rows</h3>
<p>We’re going to learn some of the most common <strong><code>dplyr</code></strong> functions: <code>select()</code>, <code>filter()</code>, <code>mutate()</code>, <code>group_by()</code>, and <code>summarize()</code>. To select columns of a data frame, use <code>select()</code>. The first argument to this function is the data frame, and the subsequent arguments are the columns to keep.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">select</span>(iprg, Protein, Run, Condition)</code></pre></div>
<p>To choose rows based on a specific criteria, use <code>filter()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(iprg, BioReplicate <span class="op">==</span><span class="st"> </span><span class="dv">1</span>)</code></pre></div>
<pre><code>## # A tibble: 9,079 x 7
##    Protein      Log2Intensity Run         Condition BioReplicate Intensity
##    &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;
##  1 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            1    1.18e8
##  2 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            1    1.02e8
##  3 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            1    1.01e8
##  4 sp|O13297|C…          24.7 JD_0623201… Conditio…            1    2.76e7
##  5 sp|O13297|C…          24.7 JD_0623201… Conditio…            1    2.68e7
##  6 sp|O13297|C…          24.7 JD_0623201… Conditio…            1    2.76e7
##  7 sp|O13329|F…          23.4 JD_0623201… Conditio…            1    1.09e7
##  8 sp|O13329|F…          24.0 JD_0623201… Conditio…            1    1.69e7
##  9 sp|O13329|F…          23.5 JD_0623201… Conditio…            1    1.16e7
## 10 sp|O13539|T…          27.5 JD_0623201… Conditio…            1    1.92e8
## # ... with 9,069 more rows, and 1 more variable: TechReplicate &lt;chr&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">filter</span>(iprg, Condition <span class="op">==</span><span class="st"> &#39;Condition2&#39;</span>)</code></pre></div>
<pre><code>## # A tibble: 9,081 x 7
##    Protein      Log2Intensity Run         Condition BioReplicate Intensity
##    &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;
##  1 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            2    1.20e8
##  2 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            2    1.16e8
##  3 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            2    1.02e8
##  4 sp|O13297|C…          24.5 JD_0623201… Conditio…            2    2.41e7
##  5 sp|O13297|C…          24.7 JD_0623201… Conditio…            2    2.68e7
##  6 sp|O13297|C…          24.6 JD_0623201… Conditio…            2    2.51e7
##  7 sp|O13329|F…          23.2 JD_0623201… Conditio…            2    9.45e6
##  8 sp|O13329|F…          23.4 JD_0623201… Conditio…            2    1.13e7
##  9 sp|O13329|F…          23.8 JD_0623201… Conditio…            2    1.43e7
## 10 sp|O13539|T…          25.9 JD_0623201… Conditio…            2    6.18e7
## # ... with 9,071 more rows, and 1 more variable: TechReplicate &lt;chr&gt;</code></pre>
</div>
<div id="pipes" class="section level3">
<h3><span class="header-section-number">2.5.2</span> Pipes</h3>
<p>But what if you wanted to select and filter at the same time? There are three ways to do this: use intermediate steps, nested functions, or pipes.</p>
<p>With intermediate steps, you essentially create a temporary data frame and use that as input to the next function. This can clutter up your workspace with lots of objects. You can also nest functions (i.e. one function inside of another). This is handy, but can be difficult to read if too many functions are nested as things are evaluated from the inside out.</p>
<p>The last option, pipes, are a fairly recent addition to R. Pipes let you take the output of one function and send it directly to the next, which is useful when you need to do many things to the same dataset. Pipes in R look like <code>%&gt;%</code> and are made available via the <code>magrittr</code> package, installed automatically with <strong><code>dplyr</code></strong>. If you use RStudio, you can type the pipe with <kbd>Ctrl</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you have a PC or <kbd>Cmd</kbd> + <kbd>Shift</kbd> + <kbd>M</kbd> if you have a Mac.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprg <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">filter</span>(Intensity <span class="op">&gt;</span><span class="st"> </span><span class="fl">1e8</span>) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">select</span>(Protein, Condition, Intensity)</code></pre></div>
<pre><code>## # A tibble: 4,729 x 3
##    Protein              Condition   Intensity
##    &lt;chr&gt;                &lt;chr&gt;           &lt;dbl&gt;
##  1 sp|D6VTK4|STE2_YEAST Condition1 117845016.
##  2 sp|D6VTK4|STE2_YEAST Condition1 102273602.
##  3 sp|D6VTK4|STE2_YEAST Condition1 100526837.
##  4 sp|D6VTK4|STE2_YEAST Condition2 119765106.
##  5 sp|D6VTK4|STE2_YEAST Condition2 116382798.
##  6 sp|D6VTK4|STE2_YEAST Condition2 102328260.
##  7 sp|D6VTK4|STE2_YEAST Condition3 103830944.
##  8 sp|D6VTK4|STE2_YEAST Condition4 102150172.
##  9 sp|D6VTK4|STE2_YEAST Condition4 105724288.
## 10 sp|O13539|THP2_YEAST Condition1 192490784.
## # ... with 4,719 more rows</code></pre>
<p>In the above, we use the pipe to send the <code>iprg</code> dataset first through <code>filter()</code> to keep rows where <code>Intensity</code> is greater than 1e8, then through <code>select()</code> to keep only the <code>Protein</code>, <code>Condition</code>, and <code>Intensity</code> columns. Since <code>%&gt;%</code> takes the object on its left and passes it as the first argument to the function on its right, we don’t need to explicitly include it as an argument to the <code>filter()</code> and <code>select()</code> functions anymore.</p>
<p>If we wanted to create a new object with this smaller version of the data, we could do so by assigning it a new name:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprg_sml &lt;-<span class="st"> </span>iprg <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(Intensity <span class="op">&gt;</span><span class="st"> </span><span class="fl">1e8</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(Protein, Condition, Intensity)

iprg_sml</code></pre></div>
<pre><code>## # A tibble: 4,729 x 3
##    Protein              Condition   Intensity
##    &lt;chr&gt;                &lt;chr&gt;           &lt;dbl&gt;
##  1 sp|D6VTK4|STE2_YEAST Condition1 117845016.
##  2 sp|D6VTK4|STE2_YEAST Condition1 102273602.
##  3 sp|D6VTK4|STE2_YEAST Condition1 100526837.
##  4 sp|D6VTK4|STE2_YEAST Condition2 119765106.
##  5 sp|D6VTK4|STE2_YEAST Condition2 116382798.
##  6 sp|D6VTK4|STE2_YEAST Condition2 102328260.
##  7 sp|D6VTK4|STE2_YEAST Condition3 103830944.
##  8 sp|D6VTK4|STE2_YEAST Condition4 102150172.
##  9 sp|D6VTK4|STE2_YEAST Condition4 105724288.
## 10 sp|O13539|THP2_YEAST Condition1 192490784.
## # ... with 4,719 more rows</code></pre>
<p>Note that the final data frame is the leftmost part of this expression.</p>
<blockquote>
<p><strong>Challenge</strong></p>
<p>Using pipes, subset the <code>iprg</code> data to include Proteins with a log2 intensity greater than 20 and retain only the columns <code>Proteins</code>, and <code>Condition</code>.</p>
</blockquote>
<p><details></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Answer
iprg <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(Log2Intensity <span class="op">&gt;</span><span class="st"> </span><span class="dv">20</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">select</span>(Protein, Condition)</code></pre></div>
<p></details></p>
</div>
<div id="mutate" class="section level3">
<h3><span class="header-section-number">2.5.3</span> Mutate</h3>
<p>Frequently you’ll want to create new columns based on the values in existing columns, for example to do unit conversions, or find the ratio of values in two columns. For this we’ll use <code>mutate()</code>.</p>
<p>To create a new column of weight in kg:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprg <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Log10Intensity =</span> <span class="kw">log10</span>(Intensity))</code></pre></div>
<pre><code>## # A tibble: 36,321 x 8
##    Protein      Log2Intensity Run         Condition BioReplicate Intensity
##    &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;
##  1 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            1    1.18e8
##  2 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            1    1.02e8
##  3 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            1    1.01e8
##  4 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            2    1.20e8
##  5 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            2    1.16e8
##  6 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            2    1.02e8
##  7 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            3    1.04e8
##  8 sp|D6VTK4|S…          26.5 JD_0623201… Conditio…            3    9.47e7
##  9 sp|D6VTK4|S…          26.5 JD_0623201… Conditio…            3    9.69e7
## 10 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            4    1.02e8
## # ... with 36,311 more rows, and 2 more variables: TechReplicate &lt;chr&gt;,
## #   Log10Intensity &lt;dbl&gt;</code></pre>
<p>You can also create a second new column based on the first new column within the same call of <code>mutate()</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprg <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Log10Intensity =</span> <span class="kw">log10</span>(Intensity),
           <span class="dt">Log10Intensity2 =</span> Log10Intensity <span class="op">*</span><span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## # A tibble: 36,321 x 9
##    Protein      Log2Intensity Run         Condition BioReplicate Intensity
##    &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;
##  1 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            1    1.18e8
##  2 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            1    1.02e8
##  3 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            1    1.01e8
##  4 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            2    1.20e8
##  5 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            2    1.16e8
##  6 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            2    1.02e8
##  7 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            3    1.04e8
##  8 sp|D6VTK4|S…          26.5 JD_0623201… Conditio…            3    9.47e7
##  9 sp|D6VTK4|S…          26.5 JD_0623201… Conditio…            3    9.69e7
## 10 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            4    1.02e8
## # ... with 36,311 more rows, and 3 more variables: TechReplicate &lt;chr&gt;,
## #   Log10Intensity &lt;dbl&gt;, Log10Intensity2 &lt;dbl&gt;</code></pre>
<p>If this runs off your screen and you just want to see the first few rows, you can use a pipe to view the <code>head()</code> of the data. (Pipes work with non-<strong><code>dplyr</code></strong> functions, too, as long as the <strong><code>dplyr</code></strong> or <code>magrittr</code> package is loaded).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprg <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Log10Intensity =</span> <span class="kw">log10</span>(Intensity)) <span class="op">%&gt;%</span>
<span class="st">  </span>head</code></pre></div>
<pre><code>## # A tibble: 6 x 8
##   Protein      Log2Intensity Run          Condition BioReplicate Intensity
##   &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;        &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;
## 1 sp|D6VTK4|S…          26.8 JD_06232014… Conditio…            1    1.18e8
## 2 sp|D6VTK4|S…          26.6 JD_06232014… Conditio…            1    1.02e8
## 3 sp|D6VTK4|S…          26.6 JD_06232014… Conditio…            1    1.01e8
## 4 sp|D6VTK4|S…          26.8 JD_06232014… Conditio…            2    1.20e8
## 5 sp|D6VTK4|S…          26.8 JD_06232014… Conditio…            2    1.16e8
## 6 sp|D6VTK4|S…          26.6 JD_06232014… Conditio…            2    1.02e8
## # ... with 2 more variables: TechReplicate &lt;chr&gt;, Log10Intensity &lt;dbl&gt;</code></pre>
<p>Note that we don’t include parentheses at the end of our call to <code>head()</code> above. When piping into a function with no additional arguments, you can call the function with or without parentheses (e.g. <code>head</code> or <code>head()</code>).</p>
<p>If you want to display more data, you can use the <code>print()</code> function at the end of your chain with the argument <code>n</code> specifying the number of rows to display:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprg <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Log10Intensity =</span> <span class="kw">log10</span>(Intensity),
               <span class="dt">Log10Intensity2 =</span> Log10Intensity <span class="op">*</span><span class="st"> </span><span class="dv">2</span>) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">print</span>(<span class="dt">n =</span> <span class="dv">20</span>)</code></pre></div>
<pre><code>## # A tibble: 36,321 x 9
##    Protein      Log2Intensity Run         Condition BioReplicate Intensity
##    &lt;chr&gt;                &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt;
##  1 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            1    1.18e8
##  2 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            1    1.02e8
##  3 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            1    1.01e8
##  4 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            2    1.20e8
##  5 sp|D6VTK4|S…          26.8 JD_0623201… Conditio…            2    1.16e8
##  6 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            2    1.02e8
##  7 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            3    1.04e8
##  8 sp|D6VTK4|S…          26.5 JD_0623201… Conditio…            3    9.47e7
##  9 sp|D6VTK4|S…          26.5 JD_0623201… Conditio…            3    9.69e7
## 10 sp|D6VTK4|S…          26.6 JD_0623201… Conditio…            4    1.02e8
## 11 sp|D6VTK4|S…          26.4 JD_0623201… Conditio…            4    8.77e7
## 12 sp|D6VTK4|S…          26.7 JD_0623201… Conditio…            4    1.06e8
## 13 sp|O13297|C…          24.7 JD_0623201… Conditio…            1    2.76e7
## 14 sp|O13297|C…          24.7 JD_0623201… Conditio…            1    2.68e7
## 15 sp|O13297|C…          24.7 JD_0623201… Conditio…            1    2.76e7
## 16 sp|O13297|C…          24.5 JD_0623201… Conditio…            2    2.41e7
## 17 sp|O13297|C…          24.7 JD_0623201… Conditio…            2    2.68e7
## 18 sp|O13297|C…          24.6 JD_0623201… Conditio…            2    2.51e7
## 19 sp|O13297|C…          24.4 JD_0623201… Conditio…            3    2.20e7
## 20 sp|O13297|C…          24.6 JD_0623201… Conditio…            3    2.59e7
## # ... with 3.63e+04 more rows, and 3 more variables: TechReplicate &lt;chr&gt;,
## #   Log10Intensity &lt;dbl&gt;, Log10Intensity2 &lt;dbl&gt;</code></pre>
<p>Let’s use a modified <code>iprg</code> data that contains missing values for the next example. It can be loaded with</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">download.file</span>(<span class="st">&quot;http://bit.ly/VisBiomedDataIprgNA&quot;</span>, <span class="st">&quot;./data/iprgna.rda&quot;</span>)
<span class="kw">load</span>(<span class="st">&quot;./data/iprgna.rda&quot;</span>)</code></pre></div>
<blockquote>
<p><strong>Challenge</strong></p>
<p>Using the <code>iprgna</code> data repeat the creation of a new <code>Log10Intensisty</code> column.</p>
</blockquote>
<p><details></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprgna <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">Log10Intensity =</span> <span class="kw">log10</span>(Intensity))</code></pre></div>
<pre><code>## # A tibble: 36,321 x 7
##    Protein      Run         Condition BioReplicate Intensity TechReplicate
##    &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;        
##  1 sp|D6VTK4|S… JD_0623201… Conditio…            1   NA      B            
##  2 sp|D6VTK4|S… JD_0623201… Conditio…            1    1.02e8 C            
##  3 sp|D6VTK4|S… JD_0623201… Conditio…            1   NA      A            
##  4 sp|D6VTK4|S… JD_0623201… Conditio…            2    1.20e8 A            
##  5 sp|D6VTK4|S… JD_0623201… Conditio…            2   NA      B            
##  6 sp|D6VTK4|S… JD_0623201… Conditio…            2    1.02e8 C            
##  7 sp|D6VTK4|S… JD_0623201… Conditio…            3    1.04e8 A            
##  8 sp|D6VTK4|S… JD_0623201… Conditio…            3    9.47e7 B            
##  9 sp|D6VTK4|S… JD_0623201… Conditio…            3    9.69e7 C            
## 10 sp|D6VTK4|S… JD_0623201… Conditio…            4    1.02e8 B            
## # ... with 36,311 more rows, and 1 more variable: Log10Intensity &lt;dbl&gt;</code></pre>
<p></details></p>
<p>The first few rows of the output are full of <code>NA</code>s, so if we wanted to remove those we could insert a <code>filter()</code> in the chain:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprgna <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Intensity)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">mutate</span>(<span class="dt">Log10Intensity =</span> <span class="kw">log10</span>(Intensity))</code></pre></div>
<pre><code>## # A tibble: 35,318 x 7
##    Protein      Run         Condition BioReplicate Intensity TechReplicate
##    &lt;chr&gt;        &lt;chr&gt;       &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;        
##  1 sp|D6VTK4|S… JD_0623201… Conditio…            1    1.02e8 C            
##  2 sp|D6VTK4|S… JD_0623201… Conditio…            2    1.20e8 A            
##  3 sp|D6VTK4|S… JD_0623201… Conditio…            2    1.02e8 C            
##  4 sp|D6VTK4|S… JD_0623201… Conditio…            3    1.04e8 A            
##  5 sp|D6VTK4|S… JD_0623201… Conditio…            3    9.47e7 B            
##  6 sp|D6VTK4|S… JD_0623201… Conditio…            3    9.69e7 C            
##  7 sp|D6VTK4|S… JD_0623201… Conditio…            4    1.02e8 B            
##  8 sp|D6VTK4|S… JD_0623201… Conditio…            4    8.77e7 C            
##  9 sp|D6VTK4|S… JD_0623201… Conditio…            4    1.06e8 A            
## 10 sp|O13297|C… JD_0623201… Conditio…            1    2.76e7 B            
## # ... with 35,308 more rows, and 1 more variable: Log10Intensity &lt;dbl&gt;</code></pre>
<p><code>is.na()</code> is a function that determines whether something is an <code>NA</code>. The <code>!</code> symbol negates the result, so we’re asking for everything that <em>is not</em> an <code>NA</code>.</p>
</div>
<div id="split-apply-combine-data-analysis-and-the-summarize-function" class="section level3">
<h3><span class="header-section-number">2.5.4</span> Split-apply-combine data analysis and the summarize() function</h3>
<p>Many data analysis tasks can be approached using the <em>split-apply-combine</em> paradigm: split the data into groups, apply some analysis to each group, and then combine the results. <strong><code>dplyr</code></strong> makes this very easy through the use of the <code>group_by()</code> function.</p>
<div id="the-summarize-function" class="section level4">
<h4><span class="header-section-number">2.5.4.1</span> The <code>summarize()</code> function</h4>
<p><code>group_by()</code> is often used together with <code>summarize()</code>, which collapses each group into a single-row summary of that group. <code>group_by()</code> takes as arguments the column names that contain the <strong>categorical</strong> variables for which you want to calculate the summary statistics. So to view the mean <code>weight</code> by sex:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprgna <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Condition) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_Intensity =</span> <span class="kw">mean</span>(Intensity))</code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   Condition  mean_Intensity
##   &lt;chr&gt;               &lt;dbl&gt;
## 1 Condition1             NA
## 2 Condition2             NA
## 3 Condition3             NA
## 4 Condition4             NA</code></pre>
<p>Unfortunately, the <code>mean</code> of any vector that contains even a single missing value is <code>NA</code>. We need to remove missing values before calculating the mean, which is done easily with the <code>na.rm</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprgna <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Condition) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_Intensity =</span> <span class="kw">mean</span>(Intensity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   Condition  mean_Intensity
##   &lt;chr&gt;               &lt;dbl&gt;
## 1 Condition1      65144912.
## 2 Condition2      64439756.
## 3 Condition3      62475797.
## 4 Condition4      63616488.</code></pre>
<p>You can also group by multiple columns:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprgna <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(TechReplicate, BioReplicate) <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">summarize</span>(<span class="dt">mean_Intensity =</span> <span class="kw">mean</span>(Intensity, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>))</code></pre></div>
<pre><code>## # A tibble: 12 x 3
## # Groups:   TechReplicate [?]
##    TechReplicate BioReplicate mean_Intensity
##    &lt;chr&gt;                &lt;int&gt;          &lt;dbl&gt;
##  1 A                        1      64891444.
##  2 A                        2      63870255.
##  3 A                        3      61648150.
##  4 A                        4      63662564.
##  5 B                        1      65563938.
##  6 B                        2      65164270.
##  7 B                        3      62758494.
##  8 B                        4      64196979.
##  9 C                        1      64978764.
## 10 C                        2      64283727.
## 11 C                        3      63020774.
## 12 C                        4      62984686.</code></pre>
</div>
<div id="tallying" class="section level4">
<h4><span class="header-section-number">2.5.4.2</span> Tallying</h4>
<p>When working with data, it is also common to want to know the number of observations found for each factor or combination of factors. For this, <strong><code>dplyr</code></strong> provides <code>tally()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">iprgna <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">group_by</span>(Condition) <span class="op">%&gt;%</span>
<span class="st">  </span>tally</code></pre></div>
<pre><code>## # A tibble: 4 x 2
##   Condition      n
##   &lt;chr&gt;      &lt;int&gt;
## 1 Condition1  9079
## 2 Condition2  9081
## 3 Condition3  9081
## 4 Condition4  9080</code></pre>
<p>Here, <code>tally()</code> is the action applied to the groups created by <code>group_by()</code> and counts the total number of records for each category.</p>
<blockquote>
<p><strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li><p>How many proteins of each technical replicate are there?</p></li>
<li><p>Use <code>group_by()</code> and <code>summarize()</code> to find the mean, min, and max intensity for each condition.</p></li>
<li><p>What are the proteins with the highest intensity in each condition?</p></li>
</ol>
</blockquote>
<p><details></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Answer 1
iprgna <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(TechReplicate) <span class="op">%&gt;%</span>
<span class="st">    </span>tally</code></pre></div>
<pre><code>## # A tibble: 3 x 2
##   TechReplicate     n
##   &lt;chr&gt;         &lt;int&gt;
## 1 A             12107
## 2 B             12106
## 3 C             12108</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Answer 2
iprgna <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Intensity)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(Condition) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">summarize</span>(<span class="dt">mean_int =</span> <span class="kw">mean</span>(Intensity),
                  <span class="dt">min_int =</span> <span class="kw">min</span>(Intensity),
                  <span class="dt">max_int =</span> <span class="kw">max</span>(Intensity))</code></pre></div>
<pre><code>## # A tibble: 4 x 4
##   Condition   mean_int min_int     max_int
##   &lt;chr&gt;          &lt;dbl&gt;   &lt;dbl&gt;       &lt;dbl&gt;
## 1 Condition1 65144912. 254608. 2841953257.
## 2 Condition2 64439756. 259513. 2757471311.
## 3 Condition3 62475797.  88409. 2659018724.
## 4 Condition4 63616488.  84850. 2881057105.</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## Answer 3
iprgna <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Intensity)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">group_by</span>(Condition) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">filter</span>(Intensity <span class="op">==</span><span class="st"> </span><span class="kw">max</span>(Intensity)) <span class="op">%&gt;%</span>
<span class="st">    </span><span class="kw">arrange</span>(Intensity)</code></pre></div>
<pre><code>## # A tibble: 4 x 6
## # Groups:   Condition [4]
##   Protein      Run          Condition BioReplicate Intensity TechReplicate
##   &lt;chr&gt;        &lt;chr&gt;        &lt;chr&gt;            &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;        
## 1 sp|P48589|R… JD_06232014… Conditio…            3    2.66e9 B            
## 2 sp|P48589|R… JD_06232014… Conditio…            2    2.76e9 B            
## 3 sp|P48589|R… JD_06232014… Conditio…            1    2.84e9 A            
## 4 sp|P48589|R… JD_06232014… Conditio…            4    2.88e9 A</code></pre>
<p></details></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exploring-and-visualising-biomolecular-data.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
