<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Visualisation of biomolecular data</title>
  <meta name="description" content="Visualisation of biomolecular data">
  <meta name="generator" content="bookdown 0.7 and GitBook 2.6.7">

  <meta property="og:title" content="Visualisation of biomolecular data" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Visualisation of biomolecular data" />
  <meta name="github-repo" content="lgatto/VisualisingBiomolecularData" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Visualisation of biomolecular data" />
  
  <meta name="twitter:description" content="Visualisation of biomolecular data" />
  

<meta name="author" content="Laurent Gatto">


<meta name="date" content="2018-04-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="using-r-and-bioconductor-for-ms-based-proteomics.html">
<link rel="next" href="interactive-visualisation.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="index.html"><a href="index.html#installation"><i class="fa fa-check"></i><b>1.1</b> Installation</a></li>
<li class="chapter" data-level="1.2" data-path="index.html"><a href="index.html#questions"><i class="fa fa-check"></i><b>1.2</b> Questions</a></li>
<li class="chapter" data-level="1.3" data-path="index.html"><a href="index.html#license"><i class="fa fa-check"></i><b>1.3</b> License</a></li>
<li class="chapter" data-level="1.4" data-path="index.html"><a href="index.html#references"><i class="fa fa-check"></i><b>1.4</b> References</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html"><i class="fa fa-check"></i><b>2</b> Example datasets and data manipulation</a><ul>
<li class="chapter" data-level="2.1" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#raw-ms-data"><i class="fa fa-check"></i><b>2.1</b> Raw MS data</a></li>
<li class="chapter" data-level="2.2" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#the-iprg-data"><i class="fa fa-check"></i><b>2.2</b> The iPRG data</a></li>
<li class="chapter" data-level="2.3" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#crc-training-data"><i class="fa fa-check"></i><b>2.3</b> CRC training data</a></li>
<li class="chapter" data-level="2.4" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#all-data"><i class="fa fa-check"></i><b>2.4</b> ALL data</a></li>
<li class="chapter" data-level="2.5" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#using-dplyr-for-data-manipulation"><i class="fa fa-check"></i><b>2.5</b> Using <code>dplyr</code> for data manipulation</a><ul>
<li class="chapter" data-level="2.5.1" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#selecting-columns-and-filtering-rows"><i class="fa fa-check"></i><b>2.5.1</b> Selecting columns and filtering rows</a></li>
<li class="chapter" data-level="2.5.2" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#pipes"><i class="fa fa-check"></i><b>2.5.2</b> Pipes</a></li>
<li class="chapter" data-level="2.5.3" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#mutate"><i class="fa fa-check"></i><b>2.5.3</b> Mutate</a></li>
<li class="chapter" data-level="2.5.4" data-path="example-datasets-and-data-manipulation.html"><a href="example-datasets-and-data-manipulation.html#split-apply-combine-data-analysis-and-the-summarize-function"><i class="fa fa-check"></i><b>2.5.4</b> Split-apply-combine data analysis and the summarize() function</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="exploring-and-visualising-biomolecular-data.html"><a href="exploring-and-visualising-biomolecular-data.html"><i class="fa fa-check"></i><b>3</b> Exploring and visualising biomolecular data</a></li>
<li class="chapter" data-level="4" data-path="plotting-in-r.html"><a href="plotting-in-r.html"><i class="fa fa-check"></i><b>4</b> Plotting in R</a><ul>
<li class="chapter" data-level="4.1" data-path="plotting-in-r.html"><a href="plotting-in-r.html#base-graphics"><i class="fa fa-check"></i><b>4.1</b> Base graphics</a></li>
<li class="chapter" data-level="4.2" data-path="plotting-in-r.html"><a href="plotting-in-r.html#plotting-with-ggplot2"><i class="fa fa-check"></i><b>4.2</b> Plotting with <code>ggplot2</code></a></li>
<li class="chapter" data-level="4.3" data-path="plotting-in-r.html"><a href="plotting-in-r.html#customising-plots"><i class="fa fa-check"></i><b>4.3</b> Customising plots</a></li>
<li class="chapter" data-level="4.4" data-path="plotting-in-r.html"><a href="plotting-in-r.html#saving-your-figures"><i class="fa fa-check"></i><b>4.4</b> Saving your figures</a></li>
<li class="chapter" data-level="4.5" data-path="plotting-in-r.html"><a href="plotting-in-r.html#references-1"><i class="fa fa-check"></i><b>4.5</b> References</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="using-r-and-bioconductor-for-ms-based-proteomics.html"><a href="using-r-and-bioconductor-for-ms-based-proteomics.html"><i class="fa fa-check"></i><b>5</b> Using R and Bioconductor for MS-based proteomics</a></li>
<li class="chapter" data-level="6" data-path="tools-and-plots.html"><a href="tools-and-plots.html"><i class="fa fa-check"></i><b>6</b> Tools and plots</a><ul>
<li class="chapter" data-level="6.1" data-path="tools-and-plots.html"><a href="tools-and-plots.html#transformations"><i class="fa fa-check"></i><b>6.1</b> Transformations</a></li>
<li class="chapter" data-level="6.2" data-path="tools-and-plots.html"><a href="tools-and-plots.html#comparing-samples-and-linear-models"><i class="fa fa-check"></i><b>6.2</b> Comparing samples and linear models</a></li>
<li class="chapter" data-level="6.3" data-path="tools-and-plots.html"><a href="tools-and-plots.html#volcano-plots"><i class="fa fa-check"></i><b>6.3</b> Volcano plots</a></li>
<li class="chapter" data-level="6.4" data-path="tools-and-plots.html"><a href="tools-and-plots.html#visualising-intersections-venn-euler-upset-plots"><i class="fa fa-check"></i><b>6.4</b> Visualising intersections: Venn, Euler, upset plots</a></li>
<li class="chapter" data-level="6.5" data-path="tools-and-plots.html"><a href="tools-and-plots.html#unsupervised-learning"><i class="fa fa-check"></i><b>6.5</b> Unsupervised learning</a><ul>
<li class="chapter" data-level="6.5.1" data-path="tools-and-plots.html"><a href="tools-and-plots.html#dimensionality-reduction-pca"><i class="fa fa-check"></i><b>6.5.1</b> Dimensionality reduction (PCA)</a></li>
<li class="chapter" data-level="6.5.2" data-path="tools-and-plots.html"><a href="tools-and-plots.html#k-means-clustering"><i class="fa fa-check"></i><b>6.5.2</b> K-means clustering</a></li>
<li class="chapter" data-level="6.5.3" data-path="tools-and-plots.html"><a href="tools-and-plots.html#hierarchical-clustering"><i class="fa fa-check"></i><b>6.5.3</b> Hierarchical clustering</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="tools-and-plots.html"><a href="tools-and-plots.html#heatmaps"><i class="fa fa-check"></i><b>6.6</b> Heatmaps</a><ul>
<li class="chapter" data-level="6.6.1" data-path="tools-and-plots.html"><a href="tools-and-plots.html#heatmap-components"><i class="fa fa-check"></i><b>6.6.1</b> Heatmap components</a></li>
<li class="chapter" data-level="6.6.2" data-path="tools-and-plots.html"><a href="tools-and-plots.html#data-reordering"><i class="fa fa-check"></i><b>6.6.2</b> Data reordering</a></li>
<li class="chapter" data-level="6.6.3" data-path="tools-and-plots.html"><a href="tools-and-plots.html#distance"><i class="fa fa-check"></i><b>6.6.3</b> Distance</a></li>
<li class="chapter" data-level="6.6.4" data-path="tools-and-plots.html"><a href="tools-and-plots.html#clustering-agglomeration"><i class="fa fa-check"></i><b>6.6.4</b> Clustering (agglomeration)</a></li>
<li class="chapter" data-level="6.6.5" data-path="tools-and-plots.html"><a href="tools-and-plots.html#image-representation"><i class="fa fa-check"></i><b>6.6.5</b> Image representation</a></li>
<li class="chapter" data-level="6.6.6" data-path="tools-and-plots.html"><a href="tools-and-plots.html#colour-mapping"><i class="fa fa-check"></i><b>6.6.6</b> Colour mapping</a></li>
<li class="chapter" data-level="6.6.7" data-path="tools-and-plots.html"><a href="tools-and-plots.html#colour-palette"><i class="fa fa-check"></i><b>6.6.7</b> Colour palette</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="interactive-visualisation.html"><a href="interactive-visualisation.html"><i class="fa fa-check"></i><b>7</b> Interactive visualisation</a></li>
<li class="chapter" data-level="8" data-path="session-information.html"><a href="session-information.html"><i class="fa fa-check"></i><b>8</b> Session information</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Visualisation of biomolecular data</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tools-and-plots" class="section level1">
<h1><span class="header-section-number">Chapter 6</span> Tools and plots</h1>
<div id="transformations" class="section level2">
<h2><span class="header-section-number">6.1</span> Transformations</h2>
<p>Let’s start with the comparison of two vectors of matching expression intensities such as those from two samples in the <code>iprg3</code> dataset. Let’s extract the intensities of samples JD_06232014_sample1-A.raw (second column) and JD_06232014_sample1_B.raw (third column) and produce a scatter plot of one against the other.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span>iprg3[[<span class="dv">2</span>]]
y &lt;-<span class="st"> </span>iprg3[[<span class="dv">3</span>]]
<span class="kw">plot</span>(x, y)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/trans1-1.png" width="672" /></p>
<p>Due to the distribution of the raw intensities, where most of the intensities are low with very few high intensities (see density plots below), the majority of points are squeezed close to the origin of the scatter plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">density</span>(<span class="kw">na.omit</span>(x)), <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>)
<span class="kw">lines</span>(<span class="kw">density</span>(<span class="kw">na.omit</span>(y)), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
<p>This has negative effects as it (1) leads to overplotting in the low intensity range and (2) gives too much confidence in the correlation of the two vectors. A simple way to avoid this effect is to directly log-tranform the data or set the graph axes to log scales:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">log10</span>(x), <span class="kw">log10</span>(y))</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-44-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(x, y, <span class="dt">log =</span> <span class="st">&quot;xy&quot;</span>)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-44-2.png" width="672" /></p>
<p>We will see better visualisations to detect correlation between sample replicates below.</p>
<p>It is possible to generalise to production of scatter plots to more samples using the <code>pairs</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">pairs</span>(iprg3[<span class="dv">2</span><span class="op">:</span><span class="dv">6</span>], <span class="dt">log =</span> <span class="st">&quot;xy&quot;</span>)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>A lot of space is wasted by repeating the same sets of plots in the upper right and lower left triangles of the matrix. See the <code>pairs</code> documentation page.</p>
<p>Log-transformation also comes handy when computing fold-changes. Below we calculate the fold-changes and log2 fold-changes (omitting missing values)</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fc &lt;-<span class="st"> </span><span class="kw">na.omit</span>(iprg3[[<span class="dv">2</span>]] <span class="op">/</span><span class="st"> </span>iprg3[[<span class="dv">3</span>]])
lfc &lt;-<span class="st"> </span><span class="kw">log2</span>(fc)</code></pre></div>
<p>Below, we see how the log2 fold-changes become symmetrical around zero (the absence of change), with positive values corresponding to up-regulation and negative values to down-regulation.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">density</span>(lfc), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">5</span>))
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(lfc))
<span class="kw">lines</span>(<span class="kw">density</span>(fc), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)
<span class="kw">abline</span>(<span class="dt">v =</span> <span class="kw">median</span>(fc), <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p><strong>Note</strong>: when the data is already log-transformed, log fold-changes are computed by subtracting values.</p>
</div>
<div id="comparing-samples-and-linear-models" class="section level2">
<h2><span class="header-section-number">6.2</span> Comparing samples and linear models</h2>
<p>Let’s return to the scatter plot example above and focus on three replicates from consitions 1 and 4, remove missing values and log-tranform the intensites.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x &lt;-<span class="st"> </span><span class="kw">log2</span>(<span class="kw">na.omit</span>(iprg3[, <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">11</span>)]))</code></pre></div>
<p>Below, we use the <code>pairs</code> function and print the pairwise correlations in the upper right traingle.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">## put (absolute) correlations on the upper panels,
## with size proportional to the correlations.
## From ?pairs
panel.cor &lt;-<span class="st"> </span><span class="cf">function</span>(x, y, <span class="dt">digits =</span> <span class="dv">2</span>, <span class="dt">prefix =</span> <span class="st">&quot;&quot;</span>, cex.cor, ...) {
    usr &lt;-<span class="st"> </span><span class="kw">par</span>(<span class="st">&quot;usr&quot;</span>); <span class="kw">on.exit</span>(<span class="kw">par</span>(usr))
    <span class="kw">par</span>(<span class="dt">usr =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>))
    r &lt;-<span class="st"> </span><span class="kw">abs</span>(<span class="kw">cor</span>(x, y))
    txt &lt;-<span class="st"> </span><span class="kw">format</span>(<span class="kw">c</span>(r, <span class="fl">0.123456789</span>), <span class="dt">digits =</span> digits)[<span class="dv">1</span>]
    txt &lt;-<span class="st"> </span><span class="kw">paste0</span>(prefix, txt)
    <span class="cf">if</span> (<span class="kw">missing</span>(cex.cor)) cex.cor &lt;-<span class="st"> </span><span class="fl">0.8</span><span class="op">/</span><span class="kw">strwidth</span>(txt)
    <span class="kw">text</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, txt, <span class="dt">cex =</span> cex.cor <span class="op">*</span><span class="st"> </span>r)
}
<span class="kw">pairs</span>(x, <span class="dt">lower.panel =</span> panel.smooth, <span class="dt">upper.panel =</span> panel.cor)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-48-1.png" width="672" /></p>
<p>It is often assumed that high correlation is a halmark of good replication. Rather than focus on the correlation of the data, a better measurement would be to look a the log2 fold-changes, i.e. the distance between repeated measurements. The ideal way to visualise this is on an MA-plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))
r1 &lt;-<span class="st"> </span>x[[<span class="dv">1</span>]]
r2 &lt;-<span class="st"> </span>x[[<span class="dv">2</span>]]
M &lt;-<span class="st"> </span>r1 <span class="op">-</span><span class="st"> </span>r2
A &lt;-<span class="st"> </span>(r1 <span class="op">+</span><span class="st"> </span>r2)<span class="op">/</span><span class="dv">2</span>
<span class="kw">plot</span>(A, M); <span class="kw">grid</span>()
<span class="kw">library</span>(<span class="st">&quot;affy&quot;</span>)
affy<span class="op">::</span><span class="kw">ma.plot</span>(A, M)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-49-1.png" width="1152" /></p>
<p>See also this <a href="http://simplystatistics.org/2015/08/12/correlation-is-not-a-measure-of-reproducibility/">post</a> on the <em>Simply Statistics</em> blog.</p>
<p><code>abline(0, 1)</code> can be used to add a line with intercept 0 and slop 1. It we want to add the line that models the data linearly, we can calculate the parameters using the <code>lm</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lmod &lt;-<span class="st"> </span><span class="kw">lm</span>(r2 <span class="op">~</span><span class="st"> </span>r1)
<span class="kw">summary</span>(lmod)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = r2 ~ r1)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4939 -0.0721  0.0126  0.0881  3.4595 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 0.348190   0.091842   3.791 0.000153 ***
## r1          0.985878   0.003688 267.357  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3263 on 3024 degrees of freedom
## Multiple R-squared:  0.9594, Adjusted R-squared:  0.9594 
## F-statistic: 7.148e+04 on 1 and 3024 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>which can be used to add the adequate line that reflects the (linear) relationship between the two data</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(r1, r2)
<span class="kw">abline</span>(lmod, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>As we have seen in the beginning of this section, it is essential not to rely solely on the correlation value, but look at the data. This also holds true for linear (or any) modelling, which can be done by plotting the model:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(lmod)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<ul>
<li><p><em>Cook’s distance</em> is a commonly used estimate of the influence of a data point when performing a least-squares regression analysis and can be used to highlight points that particularly influence the regression.</p></li>
<li><p><em>Leverage</em> quantifies the influence of a given observation on the regression due to its location in the space of the inputs.</p></li>
</ul>
<p>See also <code>?influence.measures</code>.</p>
<blockquote>
<p><strong>Challenge</strong></p>
<ol style="list-style-type: decimal">
<li>Take any of the <code>iprg3</code> replicates, model and plot their linear relationship.</li>
<li>The Anscombe quartet is available as <code>anscombe</code>. Load it, create a linear model for one <span class="math inline">\((x_i, y_i)\)</span> pair of your choice and visualise/check the model.</li>
</ol>
</blockquote>
<p><details></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">x3 &lt;-<span class="st"> </span>anscombe[, <span class="dv">3</span>]
y3 &lt;-<span class="st"> </span>anscombe[, <span class="dv">7</span>]
lmod &lt;-<span class="st"> </span><span class="kw">lm</span>(y3 <span class="op">~</span><span class="st"> </span>x3)
<span class="kw">summary</span>(lmod)</code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y3 ~ x3)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -1.1586 -0.6146 -0.2303  0.1540  3.2411 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept)   3.0025     1.1245   2.670  0.02562 * 
## x3            0.4997     0.1179   4.239  0.00218 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.236 on 9 degrees of freedom
## Multiple R-squared:  0.6663, Adjusted R-squared:  0.6292 
## F-statistic: 17.97 on 1 and 9 DF,  p-value: 0.002176</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))
<span class="kw">plot</span>(lmod)</code></pre></div>
<p><img src="VisualisingBiomolecularData_files/figure-html/unnamed-chunk-53-1.png" width="672" /> </details></p>
</div>
<div id="volcano-plots" class="section level2">
<h2><span class="header-section-number">6.3</span> Volcano plots</h2>
</div>
<div id="visualising-intersections-venn-euler-upset-plots" class="section level2">
<h2><span class="header-section-number">6.4</span> Visualising intersections: Venn, Euler, upset plots</h2>
</div>
<div id="unsupervised-learning" class="section level2">
<h2><span class="header-section-number">6.5</span> Unsupervised learning</h2>
<p>In <strong>unsupervised learning</strong> (UML), no labels are provided, and the learning algorithm focuses solely on detecting structure in unlabelled input data. One generally differentiates between</p>
<ul>
<li><p><strong>Clustering</strong>, where the goal is to find homogeneous subgroups within the data; the grouping is based on distance between observations.</p></li>
<li><p><strong>Dimensionality reduction</strong>, where the goal is to identify patterns in the features of the data. Dimensionality reduction is often used to facilitate visualisation of the data, as well as a pre-processing method before supervised learning.</p></li>
</ul>
<p>UML presents specific challenges and benefits:</p>
<ul>
<li>there is no single goal in UML</li>
<li>there is generally much more unlabelled data available than labelled data.</li>
</ul>
<p>Unsupervised learning techniques are paramount for exploratory data analysis and visualisation.</p>
<div id="dimensionality-reduction-pca" class="section level3">
<h3><span class="header-section-number">6.5.1</span> Dimensionality reduction (PCA)</h3>
</div>
<div id="k-means-clustering" class="section level3">
<h3><span class="header-section-number">6.5.2</span> K-means clustering</h3>
</div>
<div id="hierarchical-clustering" class="section level3">
<h3><span class="header-section-number">6.5.3</span> Hierarchical clustering</h3>
</div>
</div>
<div id="heatmaps" class="section level2">
<h2><span class="header-section-number">6.6</span> Heatmaps</h2>
<p>See</p>
<blockquote>
<p>Key M. <em>A tutorial in displaying mass spectrometry-based proteomic data using heat maps</em>. BMC Bioinformatics. 2012;13 Suppl 16:S10. doi: <a href="https://doi.org/10.1186/1471-2105-13-S16-S10">10.1186/1471-2105-13-S16-S10</a>. Epub 2012 Nov 5. Review. PMID: 23176119; PMCID: PMC3489527.</p>
</blockquote>
<div id="heatmap-components" class="section level3">
<h3><span class="header-section-number">6.6.1</span> Heatmap components</h3>
</div>
<div id="data-reordering" class="section level3">
<h3><span class="header-section-number">6.6.2</span> Data reordering</h3>
</div>
<div id="distance" class="section level3">
<h3><span class="header-section-number">6.6.3</span> Distance</h3>
</div>
<div id="clustering-agglomeration" class="section level3">
<h3><span class="header-section-number">6.6.4</span> Clustering (agglomeration)</h3>
</div>
<div id="image-representation" class="section level3">
<h3><span class="header-section-number">6.6.5</span> Image representation</h3>
</div>
<div id="colour-mapping" class="section level3">
<h3><span class="header-section-number">6.6.6</span> Colour mapping</h3>
</div>
<div id="colour-palette" class="section level3">
<h3><span class="header-section-number">6.6.7</span> Colour palette</h3>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="using-r-and-bioconductor-for-ms-based-proteomics.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="interactive-visualisation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
